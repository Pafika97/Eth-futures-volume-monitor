# ETH Futures Volume Monitor (24h) — RU

Этот проект собирает и агрегирует **объём торговли фьючерсами ETH (24h notional USD)** с нескольких бирж и источников
(без приватных ключей) и показывает изменения. Есть опциональные телеграм‑оповещения при резких изменениях.

## Что именно собираем
- Binance Futures (USDT‑маржинальные и COIN‑маржинальные свопы)
- Bybit (linear/inverse)
- OKX (ETH‑USDT‑SWAP, ETH‑USD‑SWAP)
- Deribit (все фьючерсы на ETH, конвертируя base‑volume*last в USD)
- BitMEX (ETHUSDT perpetual)

Все значения приводятся к «денежному» объёму в USD (quote notional). Где API возвращает base‑объём — умножаем на last.

> Примечание: публичные API иногда слегка расходятся в трактовке полей (vol, volCcy, turnover и т.п.). В коде есть
бережные преобразования; лучше смотреть на **динамику** суммарного объёма, чем на абсолют во всех источниках.

## Установка

```bash
python -m venv .venv
. .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
cp config.example.env .env
```

Откройте `.env` и настройте параметры (опционально телеграм‑бот для алертов).

## Запуск

### Одноразовый снимок
```bash
RUN_ONCE=true python main.py
```

### Фоновый режим (poll каждые N секунд)
```bash
python main.py
```
Интервал регулируется `POLL_SECONDS` (по умолчанию 300 сек).

## Телеграм‑оповещения (опционально)
В `.env` укажите:
- `TELEGRAM_BOT_TOKEN` — токен вашего бота
- `TELEGRAM_CHAT_ID` — id чата/канала/лички

Пороги оповещений:
- `ALERT_CHANGE_PCT` — триггер по процентному изменению против последнего снимка (дефолт 10%)
- `ALERT_CHANGE_USD` — триггер по абсолютному изменению в USD (дефолт 0 — выключено)

## Хранилище данных
Создаётся локальная SQLite‑база `eth_futures_volume.db` со снапшотами по биржам и таблицей суммарных значений.
Можно анализировать историю самостоятельно (например, в pandas).

## Частые вопросы
**Можно добавить ещё источники?** Да — расширяйте `exchanges.py`: добавляйте асинхронную функцию‑адаптер
и подключайте её в `fetch_all_exchanges`.

**Почему цифры отличаются от CoinGlass/Kaiko?** Там используется более глубокая унификация и/или платные фиды. Этот
скрипт ориентирован на быстрый бесплатный обзор и динамику 24h объёмов.

**Как запускать по cron?**
```cron
*/5 * * * * cd /path/to/eth_futures_volume_monitor && /usr/bin/python3 main.py >> log.txt 2>&1
```
